<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastrar Usuário</title>
  <link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
	crossorigin="anonymous">
   <link rel="stylesheet" href="/css/cadastrarUsuario.css">
</head>

<body class="bg-light d-flex flex-column min-vh-100">
	 <!-- Navbar padrão -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="/">TransCarga</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>          
          <li class="nav-item"><a class="nav-link" href="/auth/logout">Sair</a></li>
        </ul>
      </div>
    </div>
  </nav>
  
  <!-- Conteúdo central -->
  <main class="flex-grow-1 d-flex justify-content-center align-items-center">
  
    <div class="card shadow p-4 cadastrar-form">
      <h3 class="text-center mb-4">Cadastro de Usuário</h3>
      <form method="POST" id="userForm">
        <div class="mb-3">
          <label for="username" class="form-label">Usuário</label>
          <input type="text" class="form-control" id="username" name="username" required>
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Senha</label>
          <input type="password" class="form-control" id="password" name="password" required>
        </div>
        <div class="mb-3">
          <label for="role" class="form-label">Tipo de Conta</label>
          <select class="form-select" id="role" name="role" required>
            <option value="USER">USER</option>
            <option value="ADMIN">ADMIN</option>
          </select>
        </div>
        <div class="d-grid">
          <button type="submit" class="btn btn-success">Cadastrar</button>
        </div>
      </form>
    </div>
  </main>
  
  <footer class="text-center text-muted py-3 mt-auto">
    &copy; 2025 TransCarga. Todos os direitos reservados.
  </footer>
  
  
  
  <script>
    async function onSubmit(evt) {
      evt.preventDefault();
      const form = evt.target;
      const user = {
        username: form.username.value,
        password: form.password.value,
        role: form.role.value
      };
      const res = await fetch('users/add', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(user)
      });
      if (res.ok) {
        alert('Usuário cadastrado com sucesso');
        window.location.href = 'listarUsuarios.html';
      } else {
        alert('Erro ao cadastrar usuário');
      }
    }
    window.addEventListener('DOMContentLoaded', () => {
      document.getElementById('userForm').addEventListener('submit', onSubmit);
    });
  </script>
  
  <script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-ENjdO4Dr2bkBIFxQpeoA6VKHrj6kUaaK8hZtEzI59lZ2sDZE+Fj7bPbZefUewf0Q"
			crossorigin="anonymous">
  </script>
</body>
</html>
